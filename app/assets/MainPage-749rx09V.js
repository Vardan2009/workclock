const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/tasks-C1T5qrso.js","assets/api-LW24cLYi.js","assets/index-DhGHPcRP.js","assets/index-C6jG_o14.css"])))=>i.map(i=>d[i]);
import{c as f,a as e,o as d,_ as L,r as y,b as I,d as N,e as V,f as h,w as A,g as b,t as g,u as r,F as M,n as D,h as P,i as F,j as R,k as Z,l as $,v as E,m as U,T as H,p as O,q as z,R as K,s as j,x as q,y as G}from"./index-DhGHPcRP.js";import{removeTask as J,loadTasks as Y,store as B}from"./tasks-C1T5qrso.js";import{f as _}from"./util-BrY1QKZh.js";import{a as C}from"./api-LW24cLYi.js";import{r as Q}from"./TrashIcon-Co3KW1AW.js";import{g as W,l as X}from"./auth-JpeWmowT.js";function tt(s,i){return d(),f("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",fill:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{d:"M4.75 2A2.75 2.75 0 0 0 2 4.75v6.5A2.75 2.75 0 0 0 4.75 14h3a2.75 2.75 0 0 0 2.75-2.75v-.5a.75.75 0 0 0-1.5 0v.5c0 .69-.56 1.25-1.25 1.25h-3c-.69 0-1.25-.56-1.25-1.25v-6.5c0-.69.56-1.25 1.25-1.25h3C8.44 3.5 9 4.06 9 4.75v.5a.75.75 0 0 0 1.5 0v-.5A2.75 2.75 0 0 0 7.75 2h-3Z"}),e("path",{d:"M8.03 6.28a.75.75 0 0 0-1.06-1.06L4.72 7.47a.75.75 0 0 0 0 1.06l2.25 2.25a.75.75 0 1 0 1.06-1.06l-.97-.97h7.19a.75.75 0 0 0 0-1.5H7.06l.97-.97Z"})])}function et(s,i){return d(),f("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",fill:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"fill-rule":"evenodd",d:"M1 8a7 7 0 1 1 14 0A7 7 0 0 1 1 8Zm7.75-4.25a.75.75 0 0 0-1.5 0V8c0 .414.336.75.75.75h3.25a.75.75 0 0 0 0-1.5h-2.5v-3.5Z","clip-rule":"evenodd"})])}function at(s,i){return d(),f("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",fill:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{d:"M5 3.5A1.5 1.5 0 0 1 6.5 2h3A1.5 1.5 0 0 1 11 3.5H5ZM4.5 5A1.5 1.5 0 0 0 3 6.5v.041a3.02 3.02 0 0 1 .5-.041h9c.17 0 .337.014.5.041V6.5A1.5 1.5 0 0 0 11.5 5h-7ZM12.5 8h-9A1.5 1.5 0 0 0 2 9.5v3A1.5 1.5 0 0 0 3.5 14h9a1.5 1.5 0 0 0 1.5-1.5v-3A1.5 1.5 0 0 0 12.5 8Z"})])}const nt={class:"flex"},st=["disabled"],lt=["disabled"],ot={__name:"TaskCard",props:["task","duration-modal"],setup(s){const i=s,u=y(null),w=y(0),c=y(0);let o=null;const v=y(!1),k=async()=>{try{const a=await C(`/tasks/${i.task.id}/instances/elapsed`);u.value=i.task.id,w.value=a.est_duration_sec,c.value=a.elapsed_sec,l(i.task.id)}catch{u.value=null}},T=async a=>{const t=await i.durationModal.show("Enter duration","01:30:00");if(!isNaN(t)&&t>0)try{await C(`/tasks/${a.id}/instances/start`,{method:"POST",body:JSON.stringify({est_duration_sec:t})}),u.value=a.id,w.value=t,c.value=0,l(a.id)}catch(p){console.error("Failed to start instance:",p)}},m=async a=>{try{await C(`/tasks/${a.id}/instances/stop`,{method:"POST"}),clearInterval(o),u.value=null,w.value=0,c.value=0;const{loadTasks:t}=await P(async()=>{const{loadTasks:p}=await import("./tasks-C1T5qrso.js");return{loadTasks:p}},__vite__mapDeps([0,1,2,3]));await t()}catch(t){console.error("Failed to stop instance:",t)}},l=a=>{o&&clearInterval(o),o=setInterval(async()=>{try{const t=await C(`/tasks/${a}/instances/elapsed`);c.value=t.elapsed_sec}catch(t){console.error("Failed to get elapsed time:",t),clearInterval(o)}},1e3)};return I(()=>{k()}),N(()=>{o&&clearInterval(o)}),(a,t)=>{const p=V("RouterLink");return d(),f("div",{class:D({card:!0,disabled:v.value})},[e("h2",nt,[h(p,{to:`/task/${s.task.id}`},{default:A(()=>[b(g(s.task.icon)+" "+g(s.task.title),1)]),_:1},8,["to"]),e("button",{class:"inline danger",style:{"font-size":"14px"},disabled:v.value,onClick:t[0]||(t[0]=()=>{r(J)(s.task.id),v.value=!0})},[h(r(Q),{class:"inline-icon"})],8,st)]),u.value===s.task.id?(d(),f(M,{key:0},[h(r(et),{class:"inline-icon"}),b(" Running... Estimated: "+g(r(_)(w.value))+" Elapsed: "+g(r(_)(c.value)),1),t[3]||(t[3]=e("br",null,null,-1)),e("button",{class:"danger full-width",onClick:t[1]||(t[1]=n=>m(s.task))}," Complete Task ")],64)):(d(),f(M,{key:1},[b(" Avg. estimate: "+g(r(_)(s.task.getAvgEstTime())),1),t[4]||(t[4]=e("br",null,null,-1)),b(" Avg. actual: "+g(r(_)(s.task.getAvgRealTime())),1),t[5]||(t[5]=e("br",null,null,-1)),b(" Avg. bias: "+g(r(_)(s.task.getAvgTimeBias()))+" ("+g(s.task.getAvgTimeBiasPercentage()?.toFixed(1))+"%)",1),t[6]||(t[6]=e("br",null,null,-1)),e("button",{disabled:v.value,class:"full-width",onClick:t[2]||(t[2]=n=>T(s.task))}," Start Tracking ",8,lt)],64))],2)}}},it=L(ot,[["__scopeId","data-v-d99dcb81"]]),rt={class:"time-input-group"},ut={class:"input-unit"},dt={class:"input-unit"},ct={class:"input-unit"},vt={__name:"TimeDurationModal",setup(s,{expose:i}){const u=y(!1),w=y("Enter duration"),c=y(0),o=y(0),v=y(0);let k=null;const T=F("hourInput");async function m(p="Enter duration"){return w.value=p,c.value="",o.value="",v.value="",u.value=!0,await O(),T.value.focus(),new Promise(n=>{k=n})}I(()=>{document.addEventListener("keydown",l)}),N(()=>{document.removeEventListener("keydown",l)});const l=p=>{p.key==="Escape"&&t()};function a(){const p=Number(c.value)||0,n=Math.min(Math.max(Number(o.value)||0,0),59),x=Math.min(Math.max(Number(v.value)||0,0),59),S=p*3600+n*60+x;u.value=!1,k&&k(S),k=null}function t(){u.value=!1,k&&k(null),k=null}return i({show:m,ok:a,cancel:t}),(p,n)=>(d(),R(H,{name:"fade"},{default:A(()=>[u.value?(d(),f("div",{key:0,class:"modal-overlay",onClick:t},[e("div",{class:"modal",onClick:n[3]||(n[3]=U(()=>{},["stop"]))},[e("h2",null,g(w.value),1),e("div",rt,[e("div",ut,[$(e("input",{ref_key:"hourInput",ref:T,type:"number","onUpdate:modelValue":n[0]||(n[0]=x=>c.value=x),min:"0",placeholder:"0",inputmode:"numeric",class:"time-input"},null,512),[[E,c.value,void 0,{number:!0}]])]),n[4]||(n[4]=e("span",{class:"separator"},":",-1)),e("div",dt,[$(e("input",{type:"number","onUpdate:modelValue":n[1]||(n[1]=x=>o.value=x),min:"0",max:"59",placeholder:"0",inputmode:"numeric",class:"time-input"},null,512),[[E,o.value,void 0,{number:!0}]])]),n[5]||(n[5]=e("span",{class:"separator"},":",-1)),e("div",ct,[$(e("input",{type:"number","onUpdate:modelValue":n[2]||(n[2]=x=>v.value=x),min:"0",max:"59",placeholder:"0",inputmode:"numeric",class:"time-input"},null,512),[[E,v.value,void 0,{number:!0}]])])]),e("div",{class:"buttons"},[e("button",{class:"btn btn-primary",onClick:a},"Confirm"),e("button",{class:"btn btn-secondary",onClick:t},"Cancel")])])])):Z("",!0)]),_:1}))}},mt=L(vt,[["__scopeId","data-v-1f5a5810"]]),pt={class:"flex",style:{gap:"30px","flex-wrap":"wrap"}},kt={class:"italic title"},ft={key:0,class:"empty"},wt={key:1},_t={__name:"MainPage",async setup(s){let i,u;const w=q();let c=([i,u]=z(()=>W()),i=await i,u(),i);const o=y(null),v=async m=>{m.ctrlKey&&m.key==="N"&&m.shiftKey&&(m.preventDefault(),await w.push("/new-task"))};I(async()=>{await Y(),document.addEventListener("keydown",v)}),N(()=>{document.removeEventListener("keydown",v)});const k=()=>{X(),w.push("/login")},T=m=>{const l=m.dataset.index;m.style.transitionDelay=`${l*.15}s`};return(m,l)=>(d(),f(M,null,[e("div",pt,[e("h1",kt,"Hello, "+g(r(c).username)+"!",1),e("button",{onClick:k},[h(r(tt),{class:"inline-icon"}),l[0]||(l[0]=b(" Log out ",-1))])]),e("h3",null,[h(r(at),{class:"inline-icon"}),l[1]||(l[1]=b(" Your Tasks",-1))]),h(r(K),{to:"/new-task"},{default:A(()=>[...l[2]||(l[2]=[e("button",{class:"full-width"},[b(" + Add Task "),e("span",{class:"italic translucent"},"(Ctrl+Shift+N)")],-1)])]),_:1}),r(B).tasks.length===0?(d(),f("div",ft,[...l[3]||(l[3]=[e("p",{class:"italic"},"No tasks yet. Add one to get started!",-1)])])):(d(),f("div",wt,[h(j,{name:"slide",tag:"div",appear:"",onEnter:T},{default:A(()=>[(d(!0),f(M,null,G(r(B).tasks,(a,t)=>(d(),R(it,{key:a.id,task:a,"data-index":t,"duration-modal":o.value},null,8,["task","data-index","duration-modal"]))),128))]),_:1})])),h(mt,{ref_key:"durationModal",ref:o},null,512)],64))}};export{_t as default};
