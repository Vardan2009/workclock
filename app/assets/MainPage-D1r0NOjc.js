import{c as m,a as t,o,_ as N,r as f,b as _,d as w,w as A,e as h,t as p,u as l,F as M,n as D,f as S,g as B,h as L,i as R,j as Z,k as $,v as E,l as U,T as H,m as P,p as F,R as z,q as K,s as j,x as q}from"./index-DMYWl0Kz.js";import{r as G,l as Y,s as I}from"./tasks-nfZu4ins.js";import{f as C}from"./util-BrY1QKZh.js";import{r as J}from"./TrashIcon-B2kmBiN8.js";import{g as O,l as Q}from"./auth-CsQJbyes.js";import"./api-ucJGmPF1.js";function W(n,r){return o(),m("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",fill:"currentColor","aria-hidden":"true","data-slot":"icon"},[t("path",{d:"M4.75 2A2.75 2.75 0 0 0 2 4.75v6.5A2.75 2.75 0 0 0 4.75 14h3a2.75 2.75 0 0 0 2.75-2.75v-.5a.75.75 0 0 0-1.5 0v.5c0 .69-.56 1.25-1.25 1.25h-3c-.69 0-1.25-.56-1.25-1.25v-6.5c0-.69.56-1.25 1.25-1.25h3C8.44 3.5 9 4.06 9 4.75v.5a.75.75 0 0 0 1.5 0v-.5A2.75 2.75 0 0 0 7.75 2h-3Z"}),t("path",{d:"M8.03 6.28a.75.75 0 0 0-1.06-1.06L4.72 7.47a.75.75 0 0 0 0 1.06l2.25 2.25a.75.75 0 1 0 1.06-1.06l-.97-.97h7.19a.75.75 0 0 0 0-1.5H7.06l.97-.97Z"})])}function X(n,r){return o(),m("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",fill:"currentColor","aria-hidden":"true","data-slot":"icon"},[t("path",{"fill-rule":"evenodd",d:"M1 8a7 7 0 1 1 14 0A7 7 0 0 1 1 8Zm7.75-4.25a.75.75 0 0 0-1.5 0V8c0 .414.336.75.75.75h3.25a.75.75 0 0 0 0-1.5h-2.5v-3.5Z","clip-rule":"evenodd"})])}function tt(n,r){return o(),m("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",fill:"currentColor","aria-hidden":"true","data-slot":"icon"},[t("path",{d:"M5 3.5A1.5 1.5 0 0 1 6.5 2h3A1.5 1.5 0 0 1 11 3.5H5ZM4.5 5A1.5 1.5 0 0 0 3 6.5v.041a3.02 3.02 0 0 1 .5-.041h9c.17 0 .337.014.5.041V6.5A1.5 1.5 0 0 0 11.5 5h-7ZM12.5 8h-9A1.5 1.5 0 0 0 2 9.5v3A1.5 1.5 0 0 0 3.5 14h9a1.5 1.5 0 0 0 1.5-1.5v-3A1.5 1.5 0 0 0 12.5 8Z"})])}const et={class:"flex"},nt=["disabled"],at=["disabled"],st={__name:"TaskCard",props:["task","duration-modal"],setup(n){const r=n,u=f(null),v=f(0);let d=null;const i=f(!1),k=async a=>{const e=await r.durationModal.show("Enter duration","01:30:00");!isNaN(e)&&e>0&&(a.startNewInstance(e),u.value=a.id,v.value=0,b())},c=a=>{a.stopCurrentInstance(),clearInterval(d),u.value=null,v.value=0},b=()=>{d&&clearInterval(d),d=setInterval(()=>{v.value++},1e3)};return(a,e)=>{const x=_("RouterLink");return o(),m("div",{class:D({card:!0,disabled:i.value})},[t("h2",et,[w(x,{to:`/task/${n.task.id}`},{default:A(()=>[h(p(n.task.icon)+" "+p(n.task.title),1)]),_:1},8,["to"]),t("button",{class:"inline danger",style:{"font-size":"14px"},disabled:i.value,onClick:e[0]||(e[0]=()=>{l(G)(n.task.id),i.value=!0})},[w(l(J),{class:"inline-icon"})],8,nt)]),u.value===n.task.id&&n.task.currentRunningInstance?(o(),m(M,{key:0},[w(l(X),{class:"inline-icon"}),h(" Running... Estimated: "+p(l(C)(n.task.currentRunningInstance.estDurationSec))+" Elapsed: "+p(l(C)(v.value)),1),e[3]||(e[3]=t("br",null,null,-1)),t("button",{class:"danger full-width",onClick:e[1]||(e[1]=g=>c(n.task))}," Complete Task ")],64)):(o(),m(M,{key:1},[h(" Avg. estimate: "+p(l(C)(n.task.getAvgEstTime())),1),e[4]||(e[4]=t("br",null,null,-1)),h(" Avg. actual: "+p(l(C)(n.task.getAvgRealTime())),1),e[5]||(e[5]=t("br",null,null,-1)),h(" Avg. bias: "+p(l(C)(n.task.getAvgTimeBias()))+" ("+p(n.task.getAvgTimeBiasPercentage()?.toFixed(1))+"%)",1),e[6]||(e[6]=t("br",null,null,-1)),t("button",{disabled:i.value,class:"full-width",onClick:e[2]||(e[2]=g=>k(n.task))}," Start Tracking ",8,at)],64))],2)}}},lt=N(st,[["__scopeId","data-v-54effbaa"]]),ot={class:"time-input-group"},it={class:"input-unit"},rt={class:"input-unit"},ut={class:"input-unit"},dt={__name:"TimeDurationModal",setup(n,{expose:r}){const u=f(!1),v=f("Enter duration"),d=f(0),i=f(0),k=f(0);let c=null;const b=S("hourInput");async function a(T="Enter duration"){return v.value=T,d.value="",i.value="",k.value="",u.value=!0,await P(),b.value.focus(),new Promise(s=>{c=s})}B(()=>{document.addEventListener("keydown",e)}),L(()=>{document.removeEventListener("keydown",e)});const e=T=>{T.key==="Escape"&&g()};function x(){const T=Number(d.value)||0,s=Math.min(Math.max(Number(i.value)||0,0),59),y=Math.min(Math.max(Number(k.value)||0,0),59),V=T*3600+s*60+y;u.value=!1,c&&c(V),c=null}function g(){u.value=!1,c&&c(null),c=null}return r({show:a,ok:x,cancel:g}),(T,s)=>(o(),R(H,{name:"fade"},{default:A(()=>[u.value?(o(),m("div",{key:0,class:"modal-overlay",onClick:g},[t("div",{class:"modal",onClick:s[3]||(s[3]=U(()=>{},["stop"]))},[t("h2",null,p(v.value),1),t("div",ot,[t("div",it,[$(t("input",{ref_key:"hourInput",ref:b,type:"number","onUpdate:modelValue":s[0]||(s[0]=y=>d.value=y),min:"0",placeholder:"0",inputmode:"numeric",class:"time-input"},null,512),[[E,d.value,void 0,{number:!0}]])]),s[4]||(s[4]=t("span",{class:"separator"},":",-1)),t("div",rt,[$(t("input",{type:"number","onUpdate:modelValue":s[1]||(s[1]=y=>i.value=y),min:"0",max:"59",placeholder:"0",inputmode:"numeric",class:"time-input"},null,512),[[E,i.value,void 0,{number:!0}]])]),s[5]||(s[5]=t("span",{class:"separator"},":",-1)),t("div",ut,[$(t("input",{type:"number","onUpdate:modelValue":s[2]||(s[2]=y=>k.value=y),min:"0",max:"59",placeholder:"0",inputmode:"numeric",class:"time-input"},null,512),[[E,k.value,void 0,{number:!0}]])])]),t("div",{class:"buttons"},[t("button",{class:"btn btn-primary",onClick:x},"Confirm"),t("button",{class:"btn btn-secondary",onClick:g},"Cancel")])])])):Z("",!0)]),_:1}))}},ct=N(dt,[["__scopeId","data-v-1f5a5810"]]),mt={class:"flex",style:{gap:"30px","flex-wrap":"wrap"}},vt={class:"italic title"},pt={key:0,class:"empty"},kt={key:1},bt={__name:"MainPage",async setup(n){let r,u;const v=j();let d=([r,u]=F(()=>O()),r=await r,u(),r);const i=f(null),k=async a=>{a.ctrlKey&&a.key==="N"&&a.shiftKey&&(a.preventDefault(),await v.push("/new-task"))};B(async()=>{await Y(),document.addEventListener("keydown",k)}),L(()=>{document.removeEventListener("keydown",k)});const c=()=>{Q(),v.push("/login")},b=a=>{const e=a.dataset.index;a.style.transitionDelay=`${e*.15}s`};return(a,e)=>(o(),m(M,null,[t("div",mt,[t("h1",vt,"Hello, "+p(l(d).username)+"!",1),t("button",{onClick:c},[w(l(W),{class:"inline-icon"}),e[0]||(e[0]=h(" Log out ",-1))])]),t("h3",null,[w(l(tt),{class:"inline-icon"}),e[1]||(e[1]=h(" Your Tasks",-1))]),w(l(z),{to:"/new-task"},{default:A(()=>[...e[2]||(e[2]=[t("button",{class:"full-width"},[h(" + Add Task "),t("span",{class:"italic translucent"},"(Ctrl+Shift+N)")],-1)])]),_:1}),l(I).tasks.length===0?(o(),m("div",pt,[...e[3]||(e[3]=[t("p",{class:"italic"},"No tasks yet. Add one to get started!",-1)])])):(o(),m("div",kt,[w(K,{name:"slide",tag:"div",appear:"",onEnter:b},{default:A(()=>[(o(!0),m(M,null,q(l(I).tasks,(x,g)=>(o(),R(lt,{key:x.id,task:x,"data-index":g,"duration-modal":i.value},null,8,["task","data-index","duration-modal"]))),128))]),_:1})])),w(ct,{ref_key:"durationModal",ref:i},null,512)],64))}};export{bt as default};
